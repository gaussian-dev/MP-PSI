<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8" />
    <title>mp-psi example</title>
  </head>
  <body>
    <script type="module">
      import init, { state0_serialized } from "./pkg/mp_psi.js";

      function randomBitVector(hammingWeight, size) {
        let bitVector = new Array(size).fill(0);

        for (let i = 0; i < hammingWeight; i++) {
            let sampleIndex;
            do {
                sampleIndex = Math.floor(Math.random() * size);
            } while (bitVector[sampleIndex] === 1);

            bitVector[sampleIndex] = 1;
        }
        return bitVector;
      }

      init().then(() => {
        const private_output_a_state_0 = state0_serialized();
        // slice the array into 2 arrays of 513 elements each
        const s_pk_a = private_output_a_state_0.slice(0, 513);
        const s_rlk_a = private_output_a_state_0.slice(513, 1026);
        console.log("s_pk_a", s_pk_a);
        console.log("length of s_pk_a", s_pk_a.length)
        console.log("s_rlk_a", s_rlk_a);
        console.log("length of s_rlk_a", s_rlk_a.length)

        // Generate a random bit vector
        const hammingWeight = 3;
        const size = 10;
        const bitVector = randomBitVector(hammingWeight, size);
        console.log(bitVector);

      });
    </script>
  </body>
</html>
